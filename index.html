<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HVAC Inventory Manager</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Processing Overlay -->
<div class="processing-overlay" id="processingOverlay">
    <div class="processing-content">
        <div class="spinner"></div>
        <h2>‚è≥ Processing...</h2>
        <p>Please wait...</p>
    </div>
</div>

<!-- Login Screen -->
<div class="login-screen" id="loginScreen">
    <div class="login-box">
        <h1>üîß</h1>
        <h1>HVAC Inventory</h1>
        <p>Enter your PIN to continue</p>
        <div class="error-msg" id="errorMsg">‚ùå Invalid PIN</div>
        <input type="password" class="pin-input" id="pinInput" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" inputmode="numeric" pattern="[0-9]*" autocomplete="off">
        <button class="btn btn-primary" id="loginBtn" style="width: 100%;">Login</button>
    </div>
</div>

<!-- Main App -->
<div class="app-container" id="appContainer">
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                <div>
                    <h1>üîß HVAC Inventory Manager</h1>
                    <p>Track parts from shop ‚Üí truck ‚Üí job</p>
                </div>
                <button class="btn btn-refresh" id="refreshBtn">üîÑ Refresh</button>
            </div>
            <div class="user-info">
                <span class="user-badge" id="userBadge">Loading...</span>
                <button class="logout-btn" id="logoutBtn">üîí Logout</button>
            </div>
        </div>
        
        <!-- Tabs -->
        <div class="tabs" id="tabContainer"></div>
        
        <!-- Dashboard -->
        <div id="dashboard" class="content active">
            <div id="alerts"></div>
            <div class="stats" id="statsContainer"></div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                <h2 style="margin: 0;">Current Inventory</h2>
                <input type="text" id="searchInventory" placeholder="üîç Search parts..." style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; max-width: 300px; width: 100%;">
            </div>
            
            <div class="table-container">
                <table id="inventoryTable">
                    <thead><tr id="inventoryHeader"></tr></thead>
                    <tbody id="inventoryBody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- Load Truck -->
        <div id="load-truck" class="content">
            <h2>üì¶ Load Truck from Shop</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>Scan/Select Part *</label>
                    <div class="barcode-input">
                        <input type="text" id="loadBarcode" placeholder="Scan...">
                        <button class="barcode-btn" data-barcode="loadBarcode">üì∑</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Or Select</label>
                    <select id="loadPart"></select>
                </div>
                <div class="form-group">
                    <label>Quantity *</label>
                    <input type="number" id="loadQty" value="1" min="1" inputmode="numeric">
                </div>
                <div class="form-group">
                    <label>Truck *</label>
                    <select id="loadTruck"></select>
                </div>
            </div>
            <button class="btn btn-primary" id="loadTruckBtn">Load Truck</button>
        </div>
        
        <!-- Use Parts -->
        <div id="use-parts" class="content">
            <h2>üîß Use Parts on Job</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>From Truck *</label>
                    <select id="usePartsTruck"></select>
                </div>
                <div class="form-group">
                    <label>Scan/Select Part *</label>
                    <div class="barcode-input">
                        <input type="text" id="usePartsBarcode" placeholder="Scan...">
                        <button class="barcode-btn" data-barcode="usePartsBarcode">üì∑</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Or Select</label>
                    <select id="usePartsPart"></select>
                </div>
                <div class="form-group">
                    <label>Quantity *</label>
                    <input type="number" id="usePartsQty" value="1" min="1" inputmode="numeric">
                </div>
                <div class="form-group">
                    <label>Customer/Job</label>
                    <input type="text" id="jobName" placeholder="Optional">
                </div>
            </div>
            <button class="btn btn-primary" id="usePartsBtn">Record Usage</button>
        </div>
        
        <!-- Return to Shop -->
        <div id="return-to-shop" class="content">
            <h2>‚Ü©Ô∏è Return Parts to Shop</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>From Truck *</label>
                    <select id="returnTruck"></select>
                </div>
                <div class="form-group">
                    <label>Scan/Select Part *</label>
                    <div class="barcode-input">
                        <input type="text" id="returnBarcode" placeholder="Scan...">
                        <button class="barcode-btn" data-barcode="returnBarcode">üì∑</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Or Select</label>
                    <select id="returnPart"></select>
                </div>
                <div class="form-group">
                    <label>Quantity *</label>
                    <input type="number" id="returnQty" value="1" min="1" inputmode="numeric">
                </div>
            </div>
            <button class="btn btn-primary" id="returnToShopBtn">Return to Shop</button>
        </div>
        
        <!-- History -->
        <div id="history" class="content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                <h2 style="margin: 0;">Recent Activity</h2>
                <button class="btn btn-danger" id="clearHistoryBtn" style="padding: 10px 20px; display: none;">üóëÔ∏è Clear All History</button>
            </div>
            <div id="historyList"></div>
        </div>
        
        <!-- Transfer Between Trucks -->
        <div id="transfer-trucks" class="content">
            <h2>üîÑ Transfer Between Trucks</h2>
            <p style="color: #666; margin-bottom: 20px;">Move parts from one truck to another</p>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>From Truck *</label>
                    <select id="transferFromTruck"></select>
                </div>
                <div class="form-group">
                    <label>To Truck *</label>
                    <select id="transferToTruck"></select>
                </div>
                <div class="form-group">
                    <label>Scan/Select Part *</label>
                    <div class="barcode-input">
                        <input type="text" id="transferBarcode" placeholder="Scan...">
                        <button class="barcode-btn" data-barcode="transferBarcode">üì∑</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Or Select</label>
                    <select id="transferPart"></select>
                </div>
                <div class="form-group">
                    <label>Quantity *</label>
                    <input type="number" id="transferQty" value="1" min="1" inputmode="numeric">
                </div>
            </div>
            <button class="btn btn-primary" id="transferBtn">Transfer Parts</button>
        </div>
        
        <!-- Quick Load -->
        <div id="quick-load" class="content">
            <h2>üöõ Quick Restock</h2>
            <p style="color: #666; margin-bottom: 20px;">Quickly restock items below minimum levels</p>
            
            <div class="form-group" style="max-width: 300px; margin-bottom: 20px;">
                <label>Select Location to Restock *</label>
                <select id="quickLoadLocation">
                    <option value="">-- Select Location --</option>
                    <option value="shop">üè™ Shop (from suppliers)</option>
                </select>
            </div>
            
            <div id="quickLoadList"></div>
            <button class="btn btn-primary" id="quickLoadBtn" style="margin-top: 20px; display: none;">Restock Selected Items</button>
        </div>
        
        <!-- Add Part -->
        <div id="add-part" class="content">
            <h2>‚ûï Add New Part</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>Part Name *</label>
                    <input type="text" id="partName" placeholder="e.g., Capacitor 45/5">
                </div>
                <div class="form-group">
                    <label>Category *</label>
                    <select id="partCategory">
                        <option value="">-- Select Category --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Part Number</label>
                    <input type="text" id="partNumber" placeholder="e.g., CAP-455">
                </div>
                <div class="form-group">
                    <label>Barcode</label>
                    <div class="barcode-input">
                        <input type="text" id="partBarcode" placeholder="Scan barcode">
                        <button class="barcode-btn" data-barcode="partBarcode">üì∑</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Price</label>
                    <input type="number" id="partPrice" step="0.01" placeholder="0.00" inputmode="decimal">
                </div>
                <div class="form-group">
                    <label>Purchase Link</label>
                    <input type="url" id="partLink" placeholder="https://...">
                </div>
                <div class="form-group">
                    <label>Season</label>
                    <select id="partSeason">
                        <option value="year-round">Year-Round</option>
                        <option value="cooling">Cooling (Apr-Oct)</option>
                        <option value="heating">Heating (Oct-Apr)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Shop Qty *</label>
                    <input type="number" id="shopQty" value="0" min="0" inputmode="numeric">
                </div>
                <div class="form-group">
                    <label>Min Shop Stock *</label>
                    <input type="number" id="minStock" value="2" min="0" inputmode="numeric">
                </div>
                <div class="form-group">
                    <label>Min Truck Stock</label>
                    <input type="number" id="minTruckStock" value="1" min="0" inputmode="numeric">
                </div>
            </div>
            <button class="btn btn-primary" id="addPartBtn">Add Part</button>
        </div>
        
        <!-- Categories -->
        <div id="categories" class="content">
            <div class="admin-section">
                <h2>üìÅ Category Management</h2>
                <p style="color: #666; margin-bottom: 20px;">Organize your parts with categories and subcategories</p>
                
                <h3>Add New Category</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Category Name *</label>
                        <input type="text" id="newCategoryName" placeholder="e.g., Goodman Parts">
                    </div>
                    <div class="form-group">
                        <label>Parent Category</label>
                        <select id="newCategoryParent">
                            <option value="">-- Top Level --</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" id="addCategoryBtn">Add Category</button>
                
                <h3 style="margin-top: 30px;">Current Categories</h3>
                <div id="categoryList" style="margin-top: 15px;"></div>
            </div>
        </div>
        
        <!-- Trucks -->
        <div id="trucks" class="content">
            <div class="admin-section">
                <h2>üöö Truck Management</h2>
                <p style="color: #666; margin-bottom: 20px;">Manage your fleet and assign trucks to users</p>
                
                <h3>Add New Truck</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Truck Name *</label>
                        <input type="text" id="newTruckName" placeholder="e.g., Van 3">
                    </div>
                </div>
                <button class="btn btn-primary" id="addTruckBtn">Add Truck</button>
                
                <h3 style="margin-top: 30px;">Current Trucks</h3>
                <div id="truckList" style="margin-top: 15px;"></div>
            </div>
        </div>
        
        <!-- Settings -->
        <div id="settings" class="content">
            <div class="admin-section">
                <h2>‚öôÔ∏è Settings</h2>
                <h3>Google Sheets Sync</h3>
                <p>Status: <span style="color: #28a745;">‚úÖ Connected</span></p>
                <p style="color: #666; font-size: 0.9em;">All data automatically syncs with Google Sheets</p>
                
                <h3 style="margin-top: 20px;">User Management</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" id="newUserName" placeholder="Sarah">
                    </div>
                    <div class="form-group">
                        <label>PIN (4 digits) *</label>
                        <input type="text" id="newUserPin" placeholder="1234" maxlength="4" inputmode="numeric">
                    </div>
                    <div class="form-group">
                        <label>Truck *</label>
                        <select id="newUserTruck"></select>
                    </div>
                </div>
                <button class="btn btn-primary" id="addUserBtn">Add User</button>
                <div id="userList" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>
</div>

<!-- ZXing Barcode Scanner Library -->
<script src="https://unpkg.com/@zxing/library@0.19.1/umd/index.min.js"></script>
<script src="script.js?v=4"></script>

</body>
</html>
